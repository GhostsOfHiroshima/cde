<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Access Environment Agency WFD Classifcation and Reasons for Not Achieving Good Status Data • cde</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Access Environment Agency WFD Classifcation and Reasons for Not Achieving Good Status Data">
<meta property="og:description" content="Retrieves and plots Water Framework Directive Waterbody 
  Classification and Reasons for Not Achieving Good (RNAG) status 
  information from the Environment Agency Catchment 
  Data Explorer (CDE) site 
  (https://environment.data.gov.uk/catchment-planning/).">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">cde</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/robbriers/cde">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="cde-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#cde-package" class="anchor"></a>cde package</h1></div>

<p>R package to extract Water Framework Directive (WFD) waterbody status classifications and Reasons for Not Achieving Good (RNAG) status data from the <a href="http://environment.data.gov.uk/catchment-planning/">Environment Agency Catchment Data Explorer</a> (CDE) site. Also provides quick overview plots of status classes. The data that are downloaded and summarised using this package are made available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/">Open Government Licence v3.0</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install cde from github with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"robbriers/cde"</span>)</code></pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>There are four main functions in the package:</p>
<p><code>search_names</code></p>
<p>This allows you to search the listing of sites, catchments or river basin districts on the CDE website to locate those that match the string specified. The output of this can then be used to define inputs for the following functions.</p>
<p>Searching can be performed by waterbody name (<code>name</code>), Management Catchment (<code>MC</code>), Operational Catchment (<code>OC</code>) or River Basin District (<code>RBD</code>).</p>
<p>The function returns a dataframe containing all rows that match (or partial match) the input string.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search for Management Catchments containing the string 'Avon'</span>
<span class="kw">search_names</span>(<span class="st">"Avon"</span>, <span class="st">"MC"</span>)

<span class="co"># search for waterbodies containing the string 'Till'</span>
<span class="kw">search_names</span>(<span class="st">"Till"</span>, <span class="st">"name"</span>)</code></pre></div>
<p><code>get_status</code></p>
<p>This retrieves status data from the CDE site. The data can be retrieved by specifying waterbody id (<code>WBID</code>), Management Catchment (<code>MC</code>), Operational Catchment (<code>OC</code>) or River Basin District (<code>RBD</code>). Start year (<code>startyr</code>) and end year (<code>endyr</code>) allow specific timeranges to be downloaded. For Management Catchment (<code>MC</code>), Operational Catchment (<code>OC</code>) or River Basin District (<code>RBD</code>) level downloads, waterbody type (<code>type</code>) can also be specified to allow extraction of specific waterbody types (“River”, “Lake”, “GroundWaterBody”, “TransitionalWater” or “CoastalWater”. The classification level (<code>level</code>) can also be specified; this defaults to “Overall Water Body”, which is the Level 4 classification. Other possible values are:</p>
<table class="table table">
<thead><tr class="header">
<th>Level 1</th>
<th>Level 2</th>
<th>Level 4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Ecological</td>
<td>Biological quality elements</td>
<td>Overall water body</td>
</tr>
<tr class="even">
<td>Chemical</td>
<td>Chemical Status element</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Quantitative</td>
<td>Hydromorphological Supporting Elements</td>
<td>-</td>
</tr>
<tr class="even">
<td>-</td>
<td>Other Substances</td>
<td>-</td>
</tr>
<tr class="odd">
<td>-</td>
<td>Physico-chemical quality elements</td>
<td>-</td>
</tr>
<tr class="even">
<td>-</td>
<td>Priority hazardous substances</td>
<td>-</td>
</tr>
<tr class="odd">
<td>-</td>
<td>Priority substances</td>
<td>-</td>
</tr>
<tr class="even">
<td>-</td>
<td>Quantitative Status element</td>
<td>-</td>
</tr>
<tr class="odd">
<td>-</td>
<td>Specific pollutants</td>
<td>-</td>
</tr>
<tr class="even">
<td>-</td>
<td>Supporting elements</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>For full details of the classification hierarchy used, see the details <a href="https://environment.data.gov.uk/catchment-planning/help#help-classification-hierarchy">here</a>.</p>
<p>The function returns a dataframe containing the status (and other details) for the specified combination of column, value, level and dates. Note that during 2013 and 2014 waterbodies were classified under both Cycle 1 and Cycle 2 methodologies. The status information extracted for these years is just for the Cycle 2 classification, to avoid double counting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get status information for Lakes in the Avon Hampshire Management </span>
<span class="co"># Catchment in 2012</span>
<span class="kw">get_status</span>(<span class="st">"Avon Hampshire"</span>, <span class="st">"MC"</span>, <span class="dt">startyr=</span><span class="dv">2012</span>, <span class="dt">type=</span><span class="st">"Lake"</span>)

<span class="co"># get status information for all waterbodies within the Solway Tweed</span>
<span class="co"># River Basin District in all years (2009-2015)</span>
<span class="kw">get_status</span>(<span class="st">"Solway Tweed"</span>, <span class="st">"RBD"</span>)

<span class="co"># get status information for all waterbodies within the Humber</span>
<span class="co"># River Basin District between 2012 and 2014 (BIG - 2985 rows!)</span>
<span class="kw">get_status</span>(<span class="st">"Humber"</span>, <span class="st">"RBD"</span>, <span class="dt">startyr=</span><span class="dv">2012</span>, <span class="dt">endyr=</span><span class="dv">2014</span>)

<span class="co"># get status information for WBID  GB102021073050 between 2009 and 2012</span>
<span class="kw">get_status</span>(<span class="st">"GB102021073050"</span>, <span class="st">"WBID"</span>, <span class="dt">startyr=</span><span class="dv">2009</span>, <span class="dt">endyr=</span><span class="dv">2012</span>)</code></pre></div>
<p><code>plot_status</code></p>
<p>This produces summary barplots of percentage of waterbodies at different status. As for <code>get_status</code> the year range, level and type can be specified, along with colour scheme. The default is <code>scheme="vir"</code>, which is a <code>viridis</code>-based scheme. The alternative is <code>scheme="wfd"</code>, which gives the status colours specified within the WFD. Only works for Management/Operational Catchments or River Basin District level searches.</p>
<p>When a single year is specified, the bars represent the percentage of waterbodies in each status class. When multiple years are specified, the output is a stacked barplot of status percentages for each year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot status information for Lakes in the Avon Hampshire Management </span>
<span class="co"># Catchment in 2012</span>
<span class="kw">plot_status</span>(<span class="st">"Avon Hampshire"</span>, <span class="st">"MC"</span>, <span class="dt">startyr=</span><span class="dv">2012</span>, <span class="dt">type=</span><span class="st">"Lake"</span>)

<span class="co"># plot status information for all waterbodies within the Solway Tweed</span>
<span class="co"># River Basin District in all years (2009-2015) using WFD colours</span>
<span class="kw">plot_status</span>(<span class="st">"Solway Tweed"</span>, <span class="st">"RBD"</span>, <span class="dt">scheme=</span><span class="st">"wfd"</span>)

<span class="co"># plot status information for all waterbodies within the Humber</span>
<span class="co"># River Basin District between 2012 and 2014</span>
<span class="kw">plot_status</span>(<span class="st">"Humber"</span>, <span class="st">"RBD"</span>, <span class="dt">startyr=</span><span class="dv">2012</span>, <span class="dt">endyr=</span><span class="dv">2014</span>)</code></pre></div>
<p><code>get_rnag</code></p>
<p>This retrieves data on the Reasons for Not Achieving Good (RNAG) status (i.e. pressure data) from the CDE site. The data can be retrieved by specifying waterbody id (<code>WBID</code>), Management Catchment (<code>MC</code>), Operational Catchment (<code>OC</code>) or River Basin District (<code>RBD</code>). Start year (<code>startyr</code>) and end year (<code>endyr</code>) allow specific timeranges to be downloaded. For Management Catchment (<code>MC</code>), Operational Catchment (<code>OC</code>) or River Basin District (<code>RBD</code>) level downloads, waterbody type (<code>type</code>) can also be specified to allow extraction of specific waterbody types (“River”, “Lake”, “GroundWaterBody”, “TransitionalWater” or “CoastalWater”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get RNAG issues identified for waterbody GB112071065700</span>
<span class="kw">get_rnag</span>(<span class="st">"GB112071065700"</span>, <span class="st">"WBID"</span>)

<span class="co"># get the RNAG issues for Lakes in the Humber RBD, between</span>
<span class="co"># 2012 and 2014</span>
<span class="kw">get_rnag</span>(<span class="st">"Humber"</span>, <span class="st">"RBD"</span>, <span class="dt">startyr =</span> <span class="dv">2012</span>, <span class="dt">endyr =</span> <span class="dv">2014</span>, <span class="dt">type =</span> <span class="st">"Lake"</span>)

<span class="co"># get the RNAG issues for Rivers in the Avon Warwickshire</span>
<span class="co"># Operational Catchment in 2011</span>
<span class="kw">get_rnag</span>(<span class="st">"Avon Warwickshire"</span>, <span class="st">"MC"</span>, <span class="dt">startyr =</span> <span class="dv">2011</span>, <span class="dt">type =</span> <span class="st">"River"</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/robbriers/cde">https://​github.com/​robbriers/​cde</a>
</li>
<li>Report a bug at <br><a href="https://github.com/robbriers/cde/issues">https://​github.com/​robbriers/​cde/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Rob Briers <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0341-1203" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/robbriers/cde"><img src="https://travis-ci.org/robbriers/cde.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://coveralls.io/github/robbriers/cde?branch=master"><img src="https://coveralls.io/repos/github/robbriers/cde/badge.svg?branch=master" alt="Coverage Status"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rob Briers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
